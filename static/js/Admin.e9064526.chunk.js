(this["webpackJsonpfind-a-mentor"]=this["webpackJsonpfind-a-mentor"]||[]).push([[0],{319:function(e,t,n){"use strict";n.r(t);var r=n(0),c=n(5),a=n.n(c),s=n(7),i=n(10),u=n(9),o=n(6),j=n(1),l=n(14);function b(e){return d.apply(this,arguments)}function d(){return(d=Object(i.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(l.o)("".concat(l.p.MENTORSHIP,"/requests/").concat(t,"/reminder"),null,"PUT");case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function O(e){return f.apply(this,arguments)}function f(){return(f=Object(i.a)(a.a.mark((function e(t){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(l.o)("".concat(l.p.ADMIN,"/mentor/").concat(t,"/notActive"),null,"PUT");case 2:if(!(null===(n=e.sent)||void 0===n?void 0:n.success)){e.next=5;break}return e.abrupt("return",n.data);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function h(e){return p.apply(this,arguments)}function p(){return(p=Object(i.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(l.o)("".concat(l.p.ADMIN,"/mentor/").concat(t,"/freeze"),null,"PUT");case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(e){return Object(l.o)("".concat(l.p.USERS,"/").concat(e,"/records"))}var x=n(314),v=n(315),w=n(111),S=n(109),g=n(30),k=n(4),y=n(107),D=n(79),C=n(316),A=n(41),M=n(48);function E(){var e=Object(o.a)(["\n  width: 150px;\n"]);return E=function(){return e},e}function N(){var e=Object(o.a)(["\n  display: flex;\n  align-items: center;\n  gap: 2px;\n\n  img {\n    border-radius: 50%;\n  }\n"]);return N=function(){return e},e}var T=k.c.span(N()),I=function(e,t){return e.toLocaleLowerCase().includes(t.toLocaleLowerCase())},P=k.c.div(E()),_=function(e){return e===v.a.new||e===v.a.viewed},F=function(e){var t=e.userId,n=e.mentorships,c=Object(j.useState)(!0),o=Object(u.a)(c,2),b=o[0],d=o[1],f=Object(j.useState)(),p=Object(u.a)(f,2),k=p[0],y=p[1],D=Object(j.useState)(),C=Object(u.a)(D,2),E=C[0],N=C[1];Object(j.useEffect)((function(){Promise.all([m(t),Object(l.n)(t)]).then((function(e){var t=Object(u.a)(e,2),n=t[0],r=t[1];N(r),(null===n||void 0===n?void 0:n.success)&&y(n.data.find((function(e){return 1===e.type})))})).finally((function(){return d(!1)}))}),[t]);var T=(!E||E.available)&&n.some((function(e){return!!e.reminderSentAt}))&&!n.some((function(e){var t=e.status;return t===v.a.approved||t===v.a.rejected}));return b?Object(r.jsx)(A.a,{}):T?Object(r.jsxs)(x.a,{children:[Object(r.jsx)("div",{children:E.name}),k?Object(r.jsxs)(r.Fragment,{children:[Object(r.jsxs)("div",{children:["Sent ",Object(w.b)(k.createdAt)]}),Object(r.jsx)(S.a,{onClick:Object(i.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.confirm("Are you sure you want to freeze this mentor?")){e.next=5;break}return N(Object(s.a)(Object(s.a)({},E),{},{available:!1})),e.next=4,h(E._id);case 4:g.b.success("Done");case 5:case"end":return e.stop()}}),e)}))),children:"Freeze Mentor"})]}):Object(r.jsx)(S.a,{onClick:Object(i.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O(E._id);case 2:t=e.sent,y(t),g.b.success("Done");case 5:case"end":return e.stop()}}),e)}))),children:"Send Not Active mail"}),null===E||void 0===E?void 0:E.channels.map((function(e){var t=Object(M.a)(e),n=t.url,c=t.icon;return Object(r.jsx)("div",{children:Object(r.jsxs)("a",{href:n,target:"_blank",rel:"noopener noreferrer",children:[Object(r.jsx)("i",{className:"fa fa-".concat(c)}),e.id]})})}))]}):Object(r.jsx)(r.Fragment,{})};t.default=function(){var e=Object(j.useState)(!1),t=Object(u.a)(e,2),n=t[0],c=t[1],o=Object(j.useState)(7),d=Object(u.a)(o,2),O=d[0],f=d[1],h=Object(j.useState)(""),p=Object(u.a)(h,2),m=p[0],v=p[1],k=Object(j.useState)(),A=Object(u.a)(k,2),M=A[0],E=A[1],N=Object(j.useState)(),L=Object(u.a)(N,2),U=L[0],z=L[1],q=Object(j.useState)([]),R=Object(u.a)(q,2),H=R[0],J=R[1],B=Object(j.useMemo)((function(){return H.filter((function(e){var t=e.reminderSentAt,r=e.mentor,c=e.mentee,a=e.date;return(!n||!!t)&&(!O||m||Math.floor(Object(w.a)(new Date(a)))===O)&&(!m||I(r.name,m)||I(c.name,m))})).sort((function(e,t){return new Date(t.date).getTime()-new Date(e.date).getTime()}))}),[H,m,n,O]);Object(j.useEffect)((function(){(function(){var e=new Date;return e.setDate(e.getDate()-30),Object(l.o)("".concat(l.p.MENTORSHIP,"/requests"),{from:e})})().then((function(e){(null===e||void 0===e?void 0:e.success)&&J(e.data.filter((function(e){var t=e.mentor,n=e.mentee;return!!t&&!!n})))}))}),[]),Object(j.useEffect)((function(){v((null===M||void 0===M?void 0:M.name)||"")}),[M]);var G=Object(j.useCallback)(function(){var e=Object(i.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return z(t),e.next=3,b(t);case 3:J(H.map((function(e){return e.id===t?Object(s.a)(Object(s.a)({},e),{},{reminderSentAt:(new Date).toString()}):e}))),z(null),g.b.success("Email sent");case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[H]),K=Object(j.useMemo)((function(){return["Mentor","Mentee","Status","Created","Sent"].map((function(e){return Object(r.jsx)("td",{children:e},e)}))}),[]),Q=Object(j.useMemo)((function(){return B.map((function(e){var t=e.mentor,n=e.mentee,c=e.status,a=e.date,s=e.id,i=e.reminderSentAt;return Object(r.jsxs)("tr",{style:{opacity:t.available?1:.5},children:[Object(r.jsxs)("td",{children:[Object(r.jsx)("span",{onClick:function(){return E(t)},children:t.name}),Object(r.jsx)("a",{target:"_blank",rel:"noreferrer",href:"/u/".concat(t.id),children:"\ud83d\udd17"})]}),Object(r.jsx)("td",{children:Object(r.jsxs)(T,{onClick:function(){return E(n)},children:[Object(r.jsx)("img",{src:n.avatar,width:"20",alt:""}),n.name,Object(r.jsx)("a",{target:"_blank",rel:"noreferrer",href:"mailto:".concat(n.email),children:"\ud83d\udd17"}),Object(r.jsx)("a",{target:"_blank",rel:"noreferrer",href:"/u/".concat(n.id),children:"@"})]})}),Object(r.jsx)("td",{children:c}),Object(r.jsx)("td",{children:Object(w.b)(new Date(a))}),Object(r.jsx)("td",{children:i?Object(w.b)(new Date(i)):0}),Object(r.jsx)("td",{children:_(c)&&Object(r.jsx)(S.a,{disabled:!!i,title:i&&"Sent at ".concat(new Date(i)),isLoading:s===U,onClick:function(){return G(s)},children:"Send Email"})})]},s)}))}),[B,U,G]);return Object(r.jsxs)(r.Fragment,{children:[M&&Object(r.jsx)(F,{userId:M.id,mentorships:B}),Object(r.jsxs)(x.a,{children:[Object(r.jsxs)(P,{children:[Object(r.jsx)(y.a,{children:Object(r.jsx)(D.a,{isChecked:n,label:"Sent Only",onToggle:c,size:"small"})}),Object(r.jsx)(y.a,{children:Object(r.jsx)(C.a,{type:"number",value:O,onChange:function(e){return f(e.target.valueAsNumber||0)}})}),Object(r.jsx)(y.a,{label:"User",children:Object(r.jsx)(C.a,{type:"search",value:m,onChange:function(e){return v(e.target.value)}})})]}),Q.length?Object(r.jsxs)("table",{children:[Object(r.jsx)("thead",{children:Object(r.jsx)("tr",{children:K})}),Object(r.jsx)("tbody",{children:Q})]}):Object(r.jsx)(r.Fragment,{children:"No requests"})]})]})}}}]);
//# sourceMappingURL=Admin.e9064526.chunk.js.map